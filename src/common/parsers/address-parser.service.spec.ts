import { Test, TestingModule } from '@nestjs/testing';
import { AddressParserService } from './address-parser.service';

describe('AddressParserService', () => {
  let service: AddressParserService;

  beforeEach(async () => {
    const module: TestingModule = await Test.createTestingModule({
      providers: [AddressParserService],
    }).compile();

    service = module.get<AddressParserService>(AddressParserService);
  });

  it('should be defined', () => {
    expect(service).toBeDefined();
  });

  describe('formatAddress', () => {
    it('should correctly format a contract address', () => {
      const mockContractAddress = {
        address: '0x8dbf326e12a9ff37ed6ddf75ada548c2640a6482',
        isNative: false,
        type: 'contract',
        name: 'RIF US Dollar',
        address_latest_balance_address_latest_balance_addressToaddress: {
          balance: '0',
          blockNumber: 6011251,
        },
        contract_contract_addressToaddress: {
          address: '0x8dbf326e12a9ff37ed6ddf75ada548c2640a6482',
          code: '0x60806040523661001357610011610017565b005b6100115b610027610022610074565b6100b9565b565b606061004e83836040518060600160405280602781526020016102fb602791396100dd565b9392505050565b73ffffffffffffffffffffffffffffffffffffffff163b151590565b90565b60006100b47f360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc5473ffffffffffffffffffffffffffffffffffffffff1690565b905090565b3660008037600080366000845af43d6000803e8080156100d8573d6000f35b3d6000fd5b606073ffffffffffffffffffffffffffffffffffffffff84163b610188576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152602660248201527f416464726573733a2064656c65676174652063616c6c20746f206e6f6e2d636f60448201527f6e7472616374000000000000000000000000000000000000000000000000000060648201526084015b60405180910390fd5b6000808573ffffffffffffffffffffffffffffffffffffffff16856040516101b0919061028d565b600060405180830381855af49150503d80600081146101eb576040519150601f19603f3d011682016040523d82523d6000602084013e6101f0565b606091505b509150915061020082828661020a565b9695505050505050565b6060831561021957508161004e565b8251156102295782518084602001fd5b816040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161017f91906102a9565b60005b83811015610278578181015183820152602001610260565b83811115610287576000848401525b50505050565b6000825161029f81846020870161025d565b9190910192915050565b60208152600082518060208401526102c881604085016020870161025d565b601f017fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe016919091016040019291505056fe416464726573733a206c6f772d6c6576656c2064656c65676174652063616c6c206661696c6564a26469706673582212201e3c9348ed6dd2f363e89451207bd8df182bc878dc80d47166301a510c8801e964736f6c634300080a0033',
          codeStoredAtBlock: 4402114,
          deployedCode:
            '0x608060405260405161084e38038061084e83398101604081905261002291610349565b61004d60017f360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbd610417565b600080516020610807833981519152146100695761006961043c565b6100758282600061007c565b50506104a1565b610085836100b2565b6000825111806100925750805b156100ad576100ab83836100f260201b6100291760201c565b505b505050565b6100bb8161011e565b6040516001600160a01b038216907fbc7cd75a20ee27fd9adebab32041f755214dbc6bffa90cc0225b39da2e5c2d3b90600090a250565b60606101178383604051806060016040528060278152602001610827602791396101de565b9392505050565b610131816102bc60201b6100551760201c565b6101985760405162461bcd60e51b815260206004820152602d60248201527f455243313936373a206e657720696d706c656d656e746174696f6e206973206e60448201526c1bdd08184818dbdb9d1c9858dd609a1b60648201526084015b60405180910390fd5b806101bd60008051602061080783398151915260001b6102cb60201b6100711760201c565b80546001600160a01b0319166001600160a01b039290921691909117905550565b60606001600160a01b0384163b6102465760405162461bcd60e51b815260206004820152602660248201527f416464726573733a2064656c65676174652063616c6c20746f206e6f6e2d636f6044820152651b9d1c9858dd60d21b606482015260840161018f565b600080856001600160a01b0316856040516102619190610452565b600060405180830381855af49150503d806000811461029c576040519150601f19603f3d011682016040523d82523d6000602084013e6102a1565b606091505b5090925090506102b28282866102ce565b9695505050505050565b6001600160a01b03163b151590565b90565b606083156102dd575081610117565b8251156102ed5782518084602001fd5b8160405162461bcd60e51b815260040161018f919061046e565b634e487b7160e01b600052604160045260246000fd5b60005b83811015610338578181015183820152602001610320565b838111156100ab5750506000910152565b6000806040838503121561035c57600080fd5b82516001600160a01b038116811461037357600080fd5b60208401519092506001600160401b038082111561039057600080fd5b818501915085601f8301126103a457600080fd5b8151818111156103b6576103b6610307565b604051601f8201601f19908116603f011681019083821181831017156103de576103de610307565b816040528281528860208487010111156103f757600080fd5b61040883602083016020880161031d565b80955050505050509250929050565b60008282101561043757634e487b7160e01b600052601160045260246000fd5b500390565b634e487b7160e01b600052600160045260246000fd5b6000825161046481846020870161031d565b9190910192915050565b602081526000825180602084015261048d81604085016020870161031d565b601f01601f19169190910160400192915050565b610357806104b06000396000f3fe60806040523661001357610011610017565b005b6100115b610027610022610074565b6100b9565b565b606061004e83836040518060600160405280602781526020016102fb602791396100dd565b9392505050565b73ffffffffffffffffffffffffffffffffffffffff163b151590565b90565b60006100b47f360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc5473ffffffffffffffffffffffffffffffffffffffff1690565b905090565b3660008037600080366000845af43d6000803e8080156100d8573d6000f35b3d6000fd5b606073ffffffffffffffffffffffffffffffffffffffff84163b610188576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152602660248201527f416464726573733a2064656c65676174652063616c6c20746f206e6f6e2d636f60448201527f6e7472616374000000000000000000000000000000000000000000000000000060648201526084015b60405180910390fd5b6000808573ffffffffffffffffffffffffffffffffffffffff16856040516101b0919061028d565b600060405180830381855af49150503d80600081146101eb576040519150601f19603f3d011682016040523d82523d6000602084013e6101f0565b606091505b509150915061020082828661020a565b9695505050505050565b6060831561021957508161004e565b8251156102295782518084602001fd5b816040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161017f91906102a9565b60005b83811015610278578181015183820152602001610260565b83811115610287576000848401525b50505050565b6000825161029f81846020870161025d565b9190910192915050565b60208152600082518060208401526102c881604085016020870161025d565b601f017fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe016919091016040019291505056fe416464726573733a206c6f772d6c6576656c2064656c65676174652063616c6c206661696c6564a26469706673582212201e3c9348ed6dd2f363e89451207bd8df182bc878dc80d47166301a510c8801e964736f6c634300080a0033360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc416464726573733a206c6f772d6c6576656c2064656c65676174652063616c6c206661696c6564000000000000000000000000f0b5b4a0c9bd269e49d11ff773124330733e1692000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001048f15b414000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000007d5804e33b015b43159e61188526c93cfda746f60000000000000000000000007b716178771057195bb511f0b1f7198eee62bc22000000000000000000000000000000000000000000000000000000000000000d52494620555320446f6c6c6172000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006555344524946000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
          symbol: 'USDRIF',
          decimals: 18,
          contract_creation_tx: {
            tx: '{"hash":"0x1c32cc039f1b0af11f20f98a8e86cac6f18bbf92aebf80daba45bbca9a3628a4","nonce":4148,"blockHash":"0xcc632dc7a06be236821ca9b2a22ec6cefe11bd330c10fbf31fb1552388fe347c","blockNumber":4039731,"transactionIndex":0,"from":"0xcd8a1c9acc980ae031456573e34dc05cd7dae6e3","to":null,"gas":6800000,"gasPrice":"0x3e252e0","value":"0x0","input":"0x608060405260405161084e38038061084e83398101604081905261002291610349565b61004d60017f360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbd610417565b600080516020610807833981519152146100695761006961043c565b6100758282600061007c565b50506104a1565b610085836100b2565b6000825111806100925750805b156100ad576100ab83836100f260201b6100291760201c565b505b505050565b6100bb8161011e565b6040516001600160a01b038216907fbc7cd75a20ee27fd9adebab32041f755214dbc6bffa90cc0225b39da2e5c2d3b90600090a250565b60606101178383604051806060016040528060278152602001610827602791396101de565b9392505050565b610131816102bc60201b6100551760201c565b6101985760405162461bcd60e51b815260206004820152602d60248201527f455243313936373a206e657720696d706c656d656e746174696f6e206973206e60448201526c1bdd08184818dbdb9d1c9858dd609a1b60648201526084015b60405180910390fd5b806101bd60008051602061080783398151915260001b6102cb60201b6100711760201c565b80546001600160a01b0319166001600160a01b039290921691909117905550565b60606001600160a01b0384163b6102465760405162461bcd60e51b815260206004820152602660248201527f416464726573733a2064656c65676174652063616c6c20746f206e6f6e2d636f6044820152651b9d1c9858dd60d21b606482015260840161018f565b600080856001600160a01b0316856040516102619190610452565b600060405180830381855af49150503d806000811461029c576040519150601f19603f3d011682016040523d82523d6000602084013e6102a1565b606091505b5090925090506102b28282866102ce565b9695505050505050565b6001600160a01b03163b151590565b90565b606083156102dd575081610117565b8251156102ed5782518084602001fd5b8160405162461bcd60e51b815260040161018f919061046e565b634e487b7160e01b600052604160045260246000fd5b60005b83811015610338578181015183820152602001610320565b838111156100ab5750506000910152565b6000806040838503121561035c57600080fd5b82516001600160a01b038116811461037357600080fd5b60208401519092506001600160401b038082111561039057600080fd5b818501915085601f8301126103a457600080fd5b8151818111156103b6576103b6610307565b604051601f8201601f19908116603f011681019083821181831017156103de576103de610307565b816040528281528860208487010111156103f757600080fd5b61040883602083016020880161031d565b80955050505050509250929050565b60008282101561043757634e487b7160e01b600052601160045260246000fd5b500390565b634e487b7160e01b600052600160045260246000fd5b6000825161046481846020870161031d565b9190910192915050565b602081526000825180602084015261048d81604085016020870161031d565b601f01601f19169190910160400192915050565b610357806104b06000396000f3fe60806040523661001357610011610017565b005b6100115b610027610022610074565b6100b9565b565b606061004e83836040518060600160405280602781526020016102fb602791396100dd565b9392505050565b73ffffffffffffffffffffffffffffffffffffffff163b151590565b90565b60006100b47f360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc5473ffffffffffffffffffffffffffffffffffffffff1690565b905090565b3660008037600080366000845af43d6000803e8080156100d8573d6000f35b3d6000fd5b606073ffffffffffffffffffffffffffffffffffffffff84163b610188576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152602660248201527f416464726573733a2064656c65676174652063616c6c20746f206e6f6e2d636f60448201527f6e7472616374000000000000000000000000000000000000000000000000000060648201526084015b60405180910390fd5b6000808573ffffffffffffffffffffffffffffffffffffffff16856040516101b0919061028d565b600060405180830381855af49150503d80600081146101eb576040519150601f19603f3d011682016040523d82523d6000602084013e6101f0565b606091505b509150915061020082828661020a565b9695505050505050565b6060831561021957508161004e565b8251156102295782518084602001fd5b816040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161017f91906102a9565b60005b83811015610278578181015183820152602001610260565b83811115610287576000848401525b50505050565b6000825161029f81846020870161025d565b9190910192915050565b60208152600082518060208401526102c881604085016020870161025d565b601f017fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe016919091016040019291505056fe416464726573733a206c6f772d6c6576656c2064656c65676174652063616c6c206661696c6564a26469706673582212201e3c9348ed6dd2f363e89451207bd8df182bc878dc80d47166301a510c8801e964736f6c634300080a0033360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc416464726573733a206c6f772d6c6576656c2064656c65676174652063616c6c206661696c6564000000000000000000000000f0b5b4a0c9bd269e49d11ff773124330733e1692000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001048f15b414000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000007d5804e33b015b43159e61188526c93cfda746f60000000000000000000000007b716178771057195bb511f0b1f7198eee62bc22000000000000000000000000000000000000000000000000000000000000000d52494620555320446f6c6c6172000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006555344524946000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","v":"0x61","r":"0x2bf2f6bf6f0cc21751c8f11578213dd125709f0c37e4345c4fd2f7b3ab85496a","s":"0x7002b159ce59e380dd1d2d841e85fece678b13726e0e4ac31d57ead7bb1578cb","type":"0x0","timestamp":1688581573,"receipt":{"transactionHash":"0x1c32cc039f1b0af11f20f98a8e86cac6f18bbf92aebf80daba45bbca9a3628a4","transactionIndex":0,"blockHash":"0xcc632dc7a06be236821ca9b2a22ec6cefe11bd330c10fbf31fb1552388fe347c","blockNumber":4039731,"cumulativeGasUsed":740800,"gasUsed":740800,"contractAddress":"0x8dbf326e12a9ff37ed6ddf75ada548c2640a6482","logs":[{"logIndex":0,"blockNumber":4039731,"blockHash":"0xcc632dc7a06be236821ca9b2a22ec6cefe11bd330c10fbf31fb1552388fe347c","transactionHash":"0x1c32cc039f1b0af11f20f98a8e86cac6f18bbf92aebf80daba45bbca9a3628a4","transactionIndex":0,"address":"0x8dbf326e12a9ff37ed6ddf75ada548c2640a6482","data":"0x","topics":["0xbc7cd75a20ee27fd9adebab32041f755214dbc6bffa90cc0225b39da2e5c2d3b","0x000000000000000000000000f0b5b4a0c9bd269e49d11ff773124330733e1692"]},{"logIndex":1,"blockNumber":4039731,"blockHash":"0xcc632dc7a06be236821ca9b2a22ec6cefe11bd330c10fbf31fb1552388fe347c","transactionHash":"0x1c32cc039f1b0af11f20f98a8e86cac6f18bbf92aebf80daba45bbca9a3628a4","transactionIndex":0,"address":"0x8dbf326e12a9ff37ed6ddf75ada548c2640a6482","data":"0x","topics":["0x2f8788117e7eff1d82e926ec794901d17c78024a50270940304540a733656f0d","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000007d5804e33b015b43159e61188526c93cfda746f6","0x000000000000000000000000cd8a1c9acc980ae031456573e34dc05cd7dae6e3"]},{"logIndex":2,"blockNumber":4039731,"blockHash":"0xcc632dc7a06be236821ca9b2a22ec6cefe11bd330c10fbf31fb1552388fe347c","transactionHash":"0x1c32cc039f1b0af11f20f98a8e86cac6f18bbf92aebf80daba45bbca9a3628a4","transactionIndex":0,"address":"0x8dbf326e12a9ff37ed6ddf75ada548c2640a6482","data":"0x","topics":["0x2f8788117e7eff1d82e926ec794901d17c78024a50270940304540a733656f0d","0x9f2df0fed2c77648de5860a4cc508cd0818c85b8b8a1ab4ceeef8d981c8956a6","0x0000000000000000000000007d5804e33b015b43159e61188526c93cfda746f6","0x000000000000000000000000cd8a1c9acc980ae031456573e34dc05cd7dae6e3"]},{"logIndex":3,"blockNumber":4039731,"blockHash":"0xcc632dc7a06be236821ca9b2a22ec6cefe11bd330c10fbf31fb1552388fe347c","transactionHash":"0x1c32cc039f1b0af11f20f98a8e86cac6f18bbf92aebf80daba45bbca9a3628a4","transactionIndex":0,"address":"0x8dbf326e12a9ff37ed6ddf75ada548c2640a6482","data":"0x","topics":["0x2f8788117e7eff1d82e926ec794901d17c78024a50270940304540a733656f0d","0x3c11d16cbaffd01df69ce1c404f6340ee057498f5f00246190ea54220576a848","0x0000000000000000000000007d5804e33b015b43159e61188526c93cfda746f6","0x000000000000000000000000cd8a1c9acc980ae031456573e34dc05cd7dae6e3"]},{"logIndex":4,"blockNumber":4039731,"blockHash":"0xcc632dc7a06be236821ca9b2a22ec6cefe11bd330c10fbf31fb1552388fe347c","transactionHash":"0x1c32cc039f1b0af11f20f98a8e86cac6f18bbf92aebf80daba45bbca9a3628a4","transactionIndex":0,"address":"0x8dbf326e12a9ff37ed6ddf75ada548c2640a6482","data":"0x0000000000000000000000000000000000000000000000000000000000000001","topics":["0x7f26b83ff96e1f2b6a682f133852f6798a09c465da95921460cefb3847402498"]}],"from":"0xcd8a1c9acc980ae031456573e34dc05cd7dae6e3","to":null,"status":"0x1","logsBloom":"0x00000004000018000000000000000000400000000000000000800000000000000000001000000000000000000000004000000000000000000000000000000000000400000000000000000000000002000000000000000000000000000000000000000000020000000000000000000800000000020000000000000000001000000000000000800000000000000000000000000000000080000000000000000000000000000000000000008000000400000080000000004000001000000000000000040020000000000000000000040000041000000000000100000000000060000000000000000000000000000000000000100000000000000000000000002000","type":"0x0"}}',
          },
          total_supply: [{ totalSupply: '0x10058333ff7a23807e5c' }],
          contract_method: [
            { method: 'allowance(address,address)' },
            { method: 'approve(address,uint256)' },
            { method: 'balanceOf(address)' },
            { method: 'decimals()' },
            { method: 'decreaseAllowance(address,uint256)' },
            { method: 'increaseAllowance(address,uint256)' },
            { method: 'mint(address,uint256)' },
            { method: 'name()' },
            { method: 'symbol()' },
            { method: 'totalSupply()' },
            { method: 'transfer(address,uint256)' },
            { method: 'transferFrom(address,address,uint256)' },
            { method: 'supportsInterface(bytes4)' },
            { method: 'burn(address,uint256)' },
          ],
          contract_interface: [
            { interface: 'ERC20' },
            { interface: 'ERC165' },
            { interface: 'ERC1967' },
          ],
        },
      };

      const result = service.formatAddress(mockContractAddress);

      //   expect(result).toEqual({
      //     address: '0x8dbf326e12a9ff37ed6ddf75ada548c2640a6482',
      //     balance: 0,
      //     blockNumber: 6011251,
      //     isNative: false,
      //     type: 'contract',
      //     name: 'RIF US Dollar',
      //     createdByTx: { hash: '0x1c32cc039f1b0af...' },
      //     totalSupply: 75659.5516272257,
      //     code: '0x608060405236...',
      //     deployedCode: '0x608060405260...',
      //     codeStoredAtBlock: 4402114,
      //     symbol: 'USDRIF',
      //     contractMethod: ['transfer(address,uint256)', 'balanceOf(address)'],
      //     contractInterface: ['ERC20', 'ERC165'],
      //   });

      expect(result).toEqual({
        isVerified: null,
        address: '0x8dbf326e12a9ff37ed6ddf75ada548c2640a6482',
        balance: 0,
        blockNumber: 6011251,
        isNative: false,
        type: 'contract',
        name: 'RIF US Dollar',
        createdByTx: {
          hash: '0x1c32cc039f1b0af11f20f98a8e86cac6f18bbf92aebf80daba45bbca9a3628a4',
          nonce: 4148,
          blockHash:
            '0xcc632dc7a06be236821ca9b2a22ec6cefe11bd330c10fbf31fb1552388fe347c',
          blockNumber: 4039731,
          transactionIndex: 0,
          from: '0xcd8a1c9acc980ae031456573e34dc05cd7dae6e3',
          to: null,
          gas: 6800000,
          gasPrice: '0x3e252e0',
          value: '0x0',
          input:
            '0x608060405260405161084e38038061084e83398101604081905261002291610349565b61004d60017f360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbd610417565b600080516020610807833981519152146100695761006961043c565b6100758282600061007c565b50506104a1565b610085836100b2565b6000825111806100925750805b156100ad576100ab83836100f260201b6100291760201c565b505b505050565b6100bb8161011e565b6040516001600160a01b038216907fbc7cd75a20ee27fd9adebab32041f755214dbc6bffa90cc0225b39da2e5c2d3b90600090a250565b60606101178383604051806060016040528060278152602001610827602791396101de565b9392505050565b610131816102bc60201b6100551760201c565b6101985760405162461bcd60e51b815260206004820152602d60248201527f455243313936373a206e657720696d706c656d656e746174696f6e206973206e60448201526c1bdd08184818dbdb9d1c9858dd609a1b60648201526084015b60405180910390fd5b806101bd60008051602061080783398151915260001b6102cb60201b6100711760201c565b80546001600160a01b0319166001600160a01b039290921691909117905550565b60606001600160a01b0384163b6102465760405162461bcd60e51b815260206004820152602660248201527f416464726573733a2064656c65676174652063616c6c20746f206e6f6e2d636f6044820152651b9d1c9858dd60d21b606482015260840161018f565b600080856001600160a01b0316856040516102619190610452565b600060405180830381855af49150503d806000811461029c576040519150601f19603f3d011682016040523d82523d6000602084013e6102a1565b606091505b5090925090506102b28282866102ce565b9695505050505050565b6001600160a01b03163b151590565b90565b606083156102dd575081610117565b8251156102ed5782518084602001fd5b8160405162461bcd60e51b815260040161018f919061046e565b634e487b7160e01b600052604160045260246000fd5b60005b83811015610338578181015183820152602001610320565b838111156100ab5750506000910152565b6000806040838503121561035c57600080fd5b82516001600160a01b038116811461037357600080fd5b60208401519092506001600160401b038082111561039057600080fd5b818501915085601f8301126103a457600080fd5b8151818111156103b6576103b6610307565b604051601f8201601f19908116603f011681019083821181831017156103de576103de610307565b816040528281528860208487010111156103f757600080fd5b61040883602083016020880161031d565b80955050505050509250929050565b60008282101561043757634e487b7160e01b600052601160045260246000fd5b500390565b634e487b7160e01b600052600160045260246000fd5b6000825161046481846020870161031d565b9190910192915050565b602081526000825180602084015261048d81604085016020870161031d565b601f01601f19169190910160400192915050565b610357806104b06000396000f3fe60806040523661001357610011610017565b005b6100115b610027610022610074565b6100b9565b565b606061004e83836040518060600160405280602781526020016102fb602791396100dd565b9392505050565b73ffffffffffffffffffffffffffffffffffffffff163b151590565b90565b60006100b47f360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc5473ffffffffffffffffffffffffffffffffffffffff1690565b905090565b3660008037600080366000845af43d6000803e8080156100d8573d6000f35b3d6000fd5b606073ffffffffffffffffffffffffffffffffffffffff84163b610188576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152602660248201527f416464726573733a2064656c65676174652063616c6c20746f206e6f6e2d636f60448201527f6e7472616374000000000000000000000000000000000000000000000000000060648201526084015b60405180910390fd5b6000808573ffffffffffffffffffffffffffffffffffffffff16856040516101b0919061028d565b600060405180830381855af49150503d80600081146101eb576040519150601f19603f3d011682016040523d82523d6000602084013e6101f0565b606091505b509150915061020082828661020a565b9695505050505050565b6060831561021957508161004e565b8251156102295782518084602001fd5b816040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161017f91906102a9565b60005b83811015610278578181015183820152602001610260565b83811115610287576000848401525b50505050565b6000825161029f81846020870161025d565b9190910192915050565b60208152600082518060208401526102c881604085016020870161025d565b601f017fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe016919091016040019291505056fe416464726573733a206c6f772d6c6576656c2064656c65676174652063616c6c206661696c6564a26469706673582212201e3c9348ed6dd2f363e89451207bd8df182bc878dc80d47166301a510c8801e964736f6c634300080a0033360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc416464726573733a206c6f772d6c6576656c2064656c65676174652063616c6c206661696c6564000000000000000000000000f0b5b4a0c9bd269e49d11ff773124330733e1692000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001048f15b414000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000007d5804e33b015b43159e61188526c93cfda746f60000000000000000000000007b716178771057195bb511f0b1f7198eee62bc22000000000000000000000000000000000000000000000000000000000000000d52494620555320446f6c6c6172000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006555344524946000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
          v: '0x61',
          r: '0x2bf2f6bf6f0cc21751c8f11578213dd125709f0c37e4345c4fd2f7b3ab85496a',
          s: '0x7002b159ce59e380dd1d2d841e85fece678b13726e0e4ac31d57ead7bb1578cb',
          type: '0x0',
          timestamp: 1688581573,
          receipt: {
            transactionHash:
              '0x1c32cc039f1b0af11f20f98a8e86cac6f18bbf92aebf80daba45bbca9a3628a4',
            transactionIndex: 0,
            blockHash:
              '0xcc632dc7a06be236821ca9b2a22ec6cefe11bd330c10fbf31fb1552388fe347c',
            blockNumber: 4039731,
            cumulativeGasUsed: 740800,
            gasUsed: 740800,
            contractAddress: '0x8dbf326e12a9ff37ed6ddf75ada548c2640a6482',
            logs: [
              {
                logIndex: 0,
                blockNumber: 4039731,
                blockHash:
                  '0xcc632dc7a06be236821ca9b2a22ec6cefe11bd330c10fbf31fb1552388fe347c',
                transactionHash:
                  '0x1c32cc039f1b0af11f20f98a8e86cac6f18bbf92aebf80daba45bbca9a3628a4',
                transactionIndex: 0,
                address: '0x8dbf326e12a9ff37ed6ddf75ada548c2640a6482',
                data: '0x',
                topics: [
                  '0xbc7cd75a20ee27fd9adebab32041f755214dbc6bffa90cc0225b39da2e5c2d3b',
                  '0x000000000000000000000000f0b5b4a0c9bd269e49d11ff773124330733e1692',
                ],
              },
              {
                logIndex: 1,
                blockNumber: 4039731,
                blockHash:
                  '0xcc632dc7a06be236821ca9b2a22ec6cefe11bd330c10fbf31fb1552388fe347c',
                transactionHash:
                  '0x1c32cc039f1b0af11f20f98a8e86cac6f18bbf92aebf80daba45bbca9a3628a4',
                transactionIndex: 0,
                address: '0x8dbf326e12a9ff37ed6ddf75ada548c2640a6482',
                data: '0x',
                topics: [
                  '0x2f8788117e7eff1d82e926ec794901d17c78024a50270940304540a733656f0d',
                  '0x0000000000000000000000000000000000000000000000000000000000000000',
                  '0x0000000000000000000000007d5804e33b015b43159e61188526c93cfda746f6',
                  '0x000000000000000000000000cd8a1c9acc980ae031456573e34dc05cd7dae6e3',
                ],
              },
              {
                logIndex: 2,
                blockNumber: 4039731,
                blockHash:
                  '0xcc632dc7a06be236821ca9b2a22ec6cefe11bd330c10fbf31fb1552388fe347c',
                transactionHash:
                  '0x1c32cc039f1b0af11f20f98a8e86cac6f18bbf92aebf80daba45bbca9a3628a4',
                transactionIndex: 0,
                address: '0x8dbf326e12a9ff37ed6ddf75ada548c2640a6482',
                data: '0x',
                topics: [
                  '0x2f8788117e7eff1d82e926ec794901d17c78024a50270940304540a733656f0d',
                  '0x9f2df0fed2c77648de5860a4cc508cd0818c85b8b8a1ab4ceeef8d981c8956a6',
                  '0x0000000000000000000000007d5804e33b015b43159e61188526c93cfda746f6',
                  '0x000000000000000000000000cd8a1c9acc980ae031456573e34dc05cd7dae6e3',
                ],
              },
              {
                logIndex: 3,
                blockNumber: 4039731,
                blockHash:
                  '0xcc632dc7a06be236821ca9b2a22ec6cefe11bd330c10fbf31fb1552388fe347c',
                transactionHash:
                  '0x1c32cc039f1b0af11f20f98a8e86cac6f18bbf92aebf80daba45bbca9a3628a4',
                transactionIndex: 0,
                address: '0x8dbf326e12a9ff37ed6ddf75ada548c2640a6482',
                data: '0x',
                topics: [
                  '0x2f8788117e7eff1d82e926ec794901d17c78024a50270940304540a733656f0d',
                  '0x3c11d16cbaffd01df69ce1c404f6340ee057498f5f00246190ea54220576a848',
                  '0x0000000000000000000000007d5804e33b015b43159e61188526c93cfda746f6',
                  '0x000000000000000000000000cd8a1c9acc980ae031456573e34dc05cd7dae6e3',
                ],
              },
              {
                logIndex: 4,
                blockNumber: 4039731,
                blockHash:
                  '0xcc632dc7a06be236821ca9b2a22ec6cefe11bd330c10fbf31fb1552388fe347c',
                transactionHash:
                  '0x1c32cc039f1b0af11f20f98a8e86cac6f18bbf92aebf80daba45bbca9a3628a4',
                transactionIndex: 0,
                address: '0x8dbf326e12a9ff37ed6ddf75ada548c2640a6482',
                data: '0x0000000000000000000000000000000000000000000000000000000000000001',
                topics: [
                  '0x7f26b83ff96e1f2b6a682f133852f6798a09c465da95921460cefb3847402498',
                ],
              },
            ],
            from: '0xcd8a1c9acc980ae031456573e34dc05cd7dae6e3',
            to: null,
            status: '0x1',
            logsBloom:
              '0x00000004000018000000000000000000400000000000000000800000000000000000001000000000000000000000004000000000000000000000000000000000000400000000000000000000000002000000000000000000000000000000000000000000020000000000000000000800000000020000000000000000001000000000000000800000000000000000000000000000000080000000000000000000000000000000000000008000000400000080000000004000001000000000000000040020000000000000000000040000041000000000000100000000000060000000000000000000000000000000000000100000000000000000000000002000',
            type: '0x0',
          },
        },
        totalSupply: 75659.5516272257,
        code: '0x60806040523661001357610011610017565b005b6100115b610027610022610074565b6100b9565b565b606061004e83836040518060600160405280602781526020016102fb602791396100dd565b9392505050565b73ffffffffffffffffffffffffffffffffffffffff163b151590565b90565b60006100b47f360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc5473ffffffffffffffffffffffffffffffffffffffff1690565b905090565b3660008037600080366000845af43d6000803e8080156100d8573d6000f35b3d6000fd5b606073ffffffffffffffffffffffffffffffffffffffff84163b610188576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152602660248201527f416464726573733a2064656c65676174652063616c6c20746f206e6f6e2d636f60448201527f6e7472616374000000000000000000000000000000000000000000000000000060648201526084015b60405180910390fd5b6000808573ffffffffffffffffffffffffffffffffffffffff16856040516101b0919061028d565b600060405180830381855af49150503d80600081146101eb576040519150601f19603f3d011682016040523d82523d6000602084013e6101f0565b606091505b509150915061020082828661020a565b9695505050505050565b6060831561021957508161004e565b8251156102295782518084602001fd5b816040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161017f91906102a9565b60005b83811015610278578181015183820152602001610260565b83811115610287576000848401525b50505050565b6000825161029f81846020870161025d565b9190910192915050565b60208152600082518060208401526102c881604085016020870161025d565b601f017fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe016919091016040019291505056fe416464726573733a206c6f772d6c6576656c2064656c65676174652063616c6c206661696c6564a26469706673582212201e3c9348ed6dd2f363e89451207bd8df182bc878dc80d47166301a510c8801e964736f6c634300080a0033',
        deployedCode:
          '0x608060405260405161084e38038061084e83398101604081905261002291610349565b61004d60017f360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbd610417565b600080516020610807833981519152146100695761006961043c565b6100758282600061007c565b50506104a1565b610085836100b2565b6000825111806100925750805b156100ad576100ab83836100f260201b6100291760201c565b505b505050565b6100bb8161011e565b6040516001600160a01b038216907fbc7cd75a20ee27fd9adebab32041f755214dbc6bffa90cc0225b39da2e5c2d3b90600090a250565b60606101178383604051806060016040528060278152602001610827602791396101de565b9392505050565b610131816102bc60201b6100551760201c565b6101985760405162461bcd60e51b815260206004820152602d60248201527f455243313936373a206e657720696d706c656d656e746174696f6e206973206e60448201526c1bdd08184818dbdb9d1c9858dd609a1b60648201526084015b60405180910390fd5b806101bd60008051602061080783398151915260001b6102cb60201b6100711760201c565b80546001600160a01b0319166001600160a01b039290921691909117905550565b60606001600160a01b0384163b6102465760405162461bcd60e51b815260206004820152602660248201527f416464726573733a2064656c65676174652063616c6c20746f206e6f6e2d636f6044820152651b9d1c9858dd60d21b606482015260840161018f565b600080856001600160a01b0316856040516102619190610452565b600060405180830381855af49150503d806000811461029c576040519150601f19603f3d011682016040523d82523d6000602084013e6102a1565b606091505b5090925090506102b28282866102ce565b9695505050505050565b6001600160a01b03163b151590565b90565b606083156102dd575081610117565b8251156102ed5782518084602001fd5b8160405162461bcd60e51b815260040161018f919061046e565b634e487b7160e01b600052604160045260246000fd5b60005b83811015610338578181015183820152602001610320565b838111156100ab5750506000910152565b6000806040838503121561035c57600080fd5b82516001600160a01b038116811461037357600080fd5b60208401519092506001600160401b038082111561039057600080fd5b818501915085601f8301126103a457600080fd5b8151818111156103b6576103b6610307565b604051601f8201601f19908116603f011681019083821181831017156103de576103de610307565b816040528281528860208487010111156103f757600080fd5b61040883602083016020880161031d565b80955050505050509250929050565b60008282101561043757634e487b7160e01b600052601160045260246000fd5b500390565b634e487b7160e01b600052600160045260246000fd5b6000825161046481846020870161031d565b9190910192915050565b602081526000825180602084015261048d81604085016020870161031d565b601f01601f19169190910160400192915050565b610357806104b06000396000f3fe60806040523661001357610011610017565b005b6100115b610027610022610074565b6100b9565b565b606061004e83836040518060600160405280602781526020016102fb602791396100dd565b9392505050565b73ffffffffffffffffffffffffffffffffffffffff163b151590565b90565b60006100b47f360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc5473ffffffffffffffffffffffffffffffffffffffff1690565b905090565b3660008037600080366000845af43d6000803e8080156100d8573d6000f35b3d6000fd5b606073ffffffffffffffffffffffffffffffffffffffff84163b610188576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152602660248201527f416464726573733a2064656c65676174652063616c6c20746f206e6f6e2d636f60448201527f6e7472616374000000000000000000000000000000000000000000000000000060648201526084015b60405180910390fd5b6000808573ffffffffffffffffffffffffffffffffffffffff16856040516101b0919061028d565b600060405180830381855af49150503d80600081146101eb576040519150601f19603f3d011682016040523d82523d6000602084013e6101f0565b606091505b509150915061020082828661020a565b9695505050505050565b6060831561021957508161004e565b8251156102295782518084602001fd5b816040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161017f91906102a9565b60005b83811015610278578181015183820152602001610260565b83811115610287576000848401525b50505050565b6000825161029f81846020870161025d565b9190910192915050565b60208152600082518060208401526102c881604085016020870161025d565b601f017fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe016919091016040019291505056fe416464726573733a206c6f772d6c6576656c2064656c65676174652063616c6c206661696c6564a26469706673582212201e3c9348ed6dd2f363e89451207bd8df182bc878dc80d47166301a510c8801e964736f6c634300080a0033360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc416464726573733a206c6f772d6c6576656c2064656c65676174652063616c6c206661696c6564000000000000000000000000f0b5b4a0c9bd269e49d11ff773124330733e1692000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001048f15b414000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000007d5804e33b015b43159e61188526c93cfda746f60000000000000000000000007b716178771057195bb511f0b1f7198eee62bc22000000000000000000000000000000000000000000000000000000000000000d52494620555320446f6c6c6172000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006555344524946000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
        codeStoredAtBlock: 4402114,
        symbol: 'USDRIF',
        contractMethod: [
          'allowance(address,address)',
          'approve(address,uint256)',
          'balanceOf(address)',
          'decimals()',
          'decreaseAllowance(address,uint256)',
          'increaseAllowance(address,uint256)',
          'mint(address,uint256)',
          'name()',
          'symbol()',
          'totalSupply()',
          'transfer(address,uint256)',
          'transferFrom(address,address,uint256)',
          'supportsInterface(bytes4)',
          'burn(address,uint256)',
        ],
        contractInterface: ['ERC20', 'ERC165', 'ERC1967'],
      });
    });

    it('should correctly format a regular account address', () => {
      const mockAccountAddress = {
        id: 5,
        address: '0x1fab9a0e24ffc209b01faa5a61ad4366982d0b7f',
        isNative: false,
        type: 'account',
        name: null,
        contract_destruction_tx: null,
        contract_contract_addressToaddress: null,
        address_latest_balance_address_latest_balance_addressToaddress: {
          balance: '0x3819116c9a40a4be6',
          blockNumber: 6013656,
        },
        miner_address_miner_address_addressToaddress: {
          lastBlockMined:
            '{"number":6013655,"hash":"0x00329e89f0043e06e7d1d13b831052f1fe45352e91573b29f44ec68b3b79f2d6","parentHash":"0x21b02c4a3e5a3c916571ba3b36c185b60e7b538d33734c2f0a48bc0db4089b4f","sha3Uncles":"0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347","logsBloom":"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000100000000000000010000000000000000000001000000000000000000001000000000000000000000000000020000000000080200000100000000000000000000000000000000000000000080000000000000000000000000000","transactionsRoot":"0xa91cc17e319e2671edb1353434330db97e047b48636ccf46adc18beab6960616","stateRoot":"0xc7bcad73131112f01195af816bb063d2d34f9bcf434061fd9bfa4071d59c3078","receiptsRoot":"0xd378c83622d13b9073ca32d24b90811cadd0049165b670aae11042e4c6e5d285","miner":"0x1fab9a0e24ffc209b01faa5a61ad4366982d0b7f","difficulty":"0x4ad36c1c","totalDifficulty":"0x3df7ba557bde5ea51","extraData":"0xd301914152524f57484541442d61333766656261","size":1599,"gasLimit":6800000,"gasUsed":61202,"timestamp":1738150332,"transactions":["0xeeb774e18e8312a826a21a3aba880eaa13aa00b04946efec39b7c5eb2a836182","0x9feb10674458576060a169823694e3c1d1a0b2a126a8d7c32235a1cfd049d4b0","0xb5e6eb2f80ca67ffc36dfb36a31328ce9062c8243ef861ecc2f561396afc593d"],"uncles":[],"minimumGasPrice":"0x46dafd","bitcoinMergedMiningHeader":"0x00000020333a8b03dc0e14773fecfae662d6e36fc67cf117ce1cf7af60070000000000006742cb591ce604d67bb444fbf0bf0f26916fd1135d97adf6627e2eb39870dde0c82a9a67f0ff0f1a41561c5c","bitcoinMergedMiningCoinbaseTransaction":"0x0000000000000080097c031e5288ed48b3ab038942cf3794021e719eb0417bdccc2cc5aa518b02bf6088ac0000000000000000266a24aa21a9edf4cda0e486eaef3bc8b42fe6994f58f42fd6f6a6e5cd5f6f563e4643f183895900000000000000002a6a52534b424c4f434b3a3e34cb088a3578d3068806f07b36d2318bf249be6af85e228f782107005bc2d700000000","bitcoinMergedMiningMerkleProof":"0xfc500fe1b835a3a15c1e5a784d963caf32908681e8bd8018bdf16dc2d63c3c00825727c71165096753a94f463651c5dfa2509c36a9091a723d213cb2022a9aab1f0bddbdcfe58ead724809ecfc895bf88829bc61b354a04dc032a8aa1f86617c73566367c9a2c70a5c803e180f8f2a2e6b915ead918ccbc94e6848daf897790ec6a9512c97779d794da7176954763f9fe8492a0554177f60205af0395fdeac4e13a881d95209c86f9bd6125fe77cb6e98b681bee1f7102ab6c7b3d52ef224464b2d44ead65b89fe9e816dd1339881ef8261ef74204c1700e7351179c0a8b0b01","hashForMergedMining":"0x3e34cb088a3578d3068806f07b36d2318bf249be6af85e228f782107005bc2d7","paidFees":"0x576ebd37c8","cumulativeDifficulty":"0x4ad36c1c","rskPteEdges":null,"_received":1738150359652}',
        },
      };

      const result = service.formatAddress(mockAccountAddress);

      expect(result).toEqual({
        isVerified: null,
        address: '0x1fab9a0e24ffc209b01faa5a61ad4366982d0b7f',
        balance: 64.67650077894078,
        blockNumber: 6013656,
        isNative: false,
        type: 'account',
        name: null,
        createdByTx: null, // Regular accounts don't have a contract creation transaction
      });
    });

    it('should return null when given null or undefined input', () => {
      expect(service.formatAddress(null)).toBeNull();
      expect(service.formatAddress(undefined)).toBeNull();
    });
  });
});
